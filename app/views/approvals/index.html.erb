<!-- app/views/approvals/index.html.erb -->
<div class="container mx-auto px-4 py-6">
  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center">
      <%= link_to time_sheets_path, class: "mr-4 text-gray-600 hover:text-gray-900" do %>
        <i class="fas fa-arrow-left"></i>
      <% end %>
      <h1 class="text-2xl font-bold">Aprovações</h1>
    </div>
    <div class="relative">
      <%= form_with url: approvals_path, method: :get, class: "relative" do |f| %>
        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
          <i class="fas fa-search text-gray-400"></i>
        </div>
        <%= f.text_field :search, value: params[:search], class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full pl-10 p-2.5", placeholder: "Buscar aprovações..." %>
        <%= f.hidden_field :tab, value: params[:tab] if params[:tab].present? %>
      <% end %>
    </div>
  </div>

  <div class="bg-white shadow-md rounded-lg overflow-hidden" data-controller="tabs">
    <!-- Tabs de navegação -->
    <div class="flex border-b">
      <%= link_to "#",
                  data: { tab: "pending", action: "click->tabs#switch", tabs_target: "tab" },
                  class: "px-6 py-3 text-sm font-medium #{params[:tab] != 'history' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-500 hover:text-gray-700'}" do %>
        Pendentes (<%= @pending_count %>)
      <% end %>

      <%= link_to "#",
                  data: { tab: "history", action: "click->tabs#switch", tabs_target: "tab" },
                  class: "px-6 py-3 text-sm font-medium #{params[:tab] == 'history' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-500 hover:text-gray-700'}" do %>
        Histórico
      <% end %>
    </div>

    <!-- Conteúdo da tab Pendentes -->
    <div data-tabs-target="content" data-tab="pending" class="<%= params[:tab] == 'history' ? 'hidden' : '' %>">
      <% if @pending_sheets.empty? %>
        <div class="p-8 text-center text-gray-500">
          Nenhuma solicitação pendente no momento.
        </div>
      <% else %>
        <div class="divide-y divide-gray-200">
          <% @pending_sheets.each do |time_sheet| %>
            <%= render 'approval_item', time_sheet: time_sheet %>
          <% end %>
        </div>

        <div class="mt-4 px-6 pb-4">
          <%= paginate @pending_sheets, param_name: 'pending_page' if @pending_sheets.total_pages > 1 %>
        </div>
      <% end %>
    </div>

    <!-- Conteúdo da tab Histórico -->
    <div data-tabs-target="content" data-tab="history" class="<%= params[:tab] != 'history' ? 'hidden' : '' %>">
      <% if @history_sheets.empty? %>
        <div class="p-8 text-center text-gray-500">
          Nenhuma solicitação no histórico.
        </div>
      <% else %>
        <div class="divide-y divide-gray-200">
          <% @history_sheets.each do |time_sheet| %>
            <%= render 'approval_item', time_sheet: time_sheet %>
          <% end %>
        </div>

        <div class="mt-4 px-6 pb-4">
          <%= paginate @history_sheets, param_name: 'history_page' if @history_sheets.total_pages > 1 %>
        </div>
      <% end %>
    </div>
  </div>
</div>